# Chrome Extension: Slack メッセージ非表示

このリポジトリは、Slackのチャンネルおよびスレッドで `:done:` リアクションがついたメッセージを非表示またはグレーアウト表示にするChrome拡張機能です。

## 目次

- [概要](#概要)
- [機能](#機能)
- [インストール方法](#インストール方法)
- [使用方法](#使用方法)
- [開発者向け情報](#開発者向け情報)
- [技術的詳細](#技術的詳細)

## 概要

このChrome拡張機能は、Slackのチャンネルおよびスレッドで `:done:` などのリアクションがついたメッセージを非表示または半透明（30%の不透明度）にすることで、完了したタスクや既読のメッセージを視覚的に区別し、未対応のメッセージに集中できるようにします。

リアクションの付け外しはリアルタイムで検知され、即座に表示に反映されます。

### 機能

- `:done:` リアクションがついたSlackメッセージを非表示または半透明（グレーアウト）表示
- **チャンネルとスレッド両方に対応** - メインチャンネルだけでなく、スレッドパネル内のメッセージも処理対象
- **リアルタイム検知** - リアクションの付け外しを即座に検知して表示に反映
- 拡張機能アイコンのクリックで表示モードの切り替え（Dimmedモード ⇔ Disappearモード）
- 対応する絵文字バリエーション: `:done:`, `:done_1:`, `:done-1:`, `:done_ja:`, `:done_en:`
- Slackチャンネル/スレッドのスクロールに対応し、新しく表示されたメッセージも自動的に処理
- デバウンス処理による効率的なDOM監視（パフォーマンス最適化）

## インストール方法

1. このリポジトリをクローンまたはダウンロード
2. Chromeブラウザで `chrome://extensions/` を開く
3. 右上の「デベロッパーモード」をオンにする
4. 「パッケージ化されていない拡張機能を読み込む」をクリック
5. ダウンロードしたリポジトリのフォルダを選択

## 使用方法

1. Slackのウェブアプリ（`https://app.slack.com/client/*`）を開く
2. 拡張機能のアイコンをクリックして、表示モードを切り替える
   - **Dimmedモード（デフォルト）**: `:done:` リアクションがついたメッセージは半透明（30%の不透明度）でグレーアウト表示
   - **Disappearモード**: `:done:` リアクションがついたメッセージは完全に非表示
3. リアクションを付けると即座に表示が変わり、外すと元に戻ります


## 開発者向け情報

### 技術的詳細

この拡張機能は以下のファイルで構成されています：

| ファイル | 説明 |
|---------|------|
| `manifest.json` | 拡張機能の設定ファイル |
| `background.js` | バックグラウンドで動作し、拡張機能の状態管理とコンテンツスクリプトとの通信を担当 |
| `content_scripts.js` | Slack UIのDOM操作を行い、メッセージの表示/非表示を制御 |
| `constants.js` | 共通定数を定義するモジュール（参照用） |
| `images/` | 拡張機能のアイコン画像 |

### コードの構造

- `background.js`: 
  - 拡張機能のインストール/更新時に初期化処理を実行
  - Slackページの読み込み完了時にコンテンツスクリプトへ通知
  - 拡張機能アイコンのクリック時にDisappear状態をトグルしてコンテンツスクリプトへ通知
  - セッションストレージ（`chrome.storage.session`）を使用して表示モードの状態を管理
  - `async/await` ベースの非同期処理

- `content_scripts.js`:
  - Slack UIのDOMを操作してメッセージの表示/非表示を制御
  - `MutationObserver` を使用してDOM変更をリアルタイム監視
    - `childList: true` - スクロールによる子要素の追加・削除を検知
    - `subtree: true` - リアクションの付け外しを検知
  - メインチャンネルとスレッドパネル両方のスクロールコンテナを監視
  - デバウンス処理（100ms）により頻繁なDOM更新を最適化
  - 対象の絵文字リアクションを `Set` で高速検索

- `constants.js`:
  - 共通定数を定義（現在は参照用モジュール）
  - メッセージタイプ、対象絵文字、透過率、URLパターン、DOMセレクタを一元管理

### 対象となる絵文字

以下の絵文字リアクションが付いたメッセージが処理対象となります：

  - ":done:"
  - ":done_1:"
  - ":done-1:"
  - ":done_ja:"
  - ":done_en:"

### 透過率設定

  - 透過率 0%（完全に表示）
  - 透過率 70%（グレーアウト）
